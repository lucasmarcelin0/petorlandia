{% extends "layout.html" %}
{% set ns = namespace(items=[]) %}
{% for a in animals %}
  {% set ns.items = ns.items + [{"@type": "Offer", "name": a.name, "description": a.description, "image": a.image}] %}
{% endfor %}
{% block head %}
  {{ super() }}
  <meta name="description" content="Animais dispon√≠veis para ado√ß√£o ou venda na PetOrl√¢ndia">
  <script type="application/ld+json">
    {{ {"@context": "https://schema.org", "@type": "ItemList", "itemListElement": ns.items} | tojson }}
  </script>
{% endblock %}
{% block main %}
<div class="container mt-4">
  <h2 class="mb-4 text-center">üêæ Animais üêæ</h2>

  {% if is_admin %}
  <div class="text-end mb-3">
    {% if show_all %}
    <a href="{{ url_for('list_animals') }}" class="btn btn-outline-secondary rounded-pill">Ver como usu√°rio</a>
    {% else %}
    <a href="{{ url_for('list_animals', show_all=1) }}" class="btn btn-outline-secondary rounded-pill">Ver todos os animais</a>
    {% endif %}
  </div>
  {% endif %}

  <!-- Filtro -->
  <form id="filterForm" method="GET" action="{{ url_for('list_animals') }}" class="mb-4">
    <div class="row g-2 justify-content-center">
      <div class="col-md-3">
        <input type="text" name="name" value="{{ name or '' }}" class="form-control rounded-pill" placeholder="Nome do pet">
      </div>
      <div class="col-md-2">
        <select name="modo" class="form-select rounded-pill">
          <option value="todos">Todos os Modos</option>
          <option value="doa√ß√£o" {% if modo == 'doa√ß√£o' %}selected{% endif %}>Ado√ß√£o</option>
          <option value="venda" {% if modo == 'venda' %}selected{% endif %}>Venda</option>
          <option value="perdido" {% if modo == 'perdido' %}selected{% endif %}>Perdido</option>
          {% if current_user.worker in ['veterinario', 'colaborador'] %}
          <option value="adotado" {% if modo == 'adotado' %}selected{% endif %}>Adotados/Com Tutor</option>
          {% endif %}
        </select>
      </div>
      <div class="col-md-2">
        <select name="species_id" class="form-select rounded-pill">
          <option value="">Todas Esp√©cies</option>
          {% for s in species_list %}
          <option value="{{ s.id }}" {% if species_id == s.id %}selected{% endif %}>{{ s.name }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="col-md-2">
        <select name="breed_id" class="form-select rounded-pill">
          <option value="">Todas Ra√ßas</option>
          {% for b in breed_list %}
          <option value="{{ b.id }}" {% if breed_id == b.id %}selected{% endif %}>{{ b.name }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="col-md-2">
        <select name="sex" class="form-select rounded-pill">
          <option value="">Sexo</option>
          <option value="Macho" {% if sex == 'Macho' %}selected{% endif %}>Macho</option>
          <option value="F√™mea" {% if sex == 'F√™mea' %}selected{% endif %}>F√™mea</option>
        </select>
      </div>
      <div class="col-md-2">
        <input type="number" name="age" value="{{ '' if age is none else age }}" class="form-control rounded-pill" placeholder="Idade">
      </div>
      <div class="col-md-1">
        <button type="submit" class="btn btn-outline-primary w-100 rounded-pill">Filtrar</button>
      </div>
    </div>
  </form>

  <!-- Cards -->
  <div id="animals-container">
    {% include 'animais/_animals_grid.html' %}
  </div>
</div>
<script type="module" src="{{ url_for('static', filename='js/animals.js') }}"></script>
{% endblock %}
