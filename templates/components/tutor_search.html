{#
  Partial: Accessible tutor search combobox
  Parameters:
    id_prefix (str): base identifier for input/list/status ids. Defaults to 'tutor-search'.
    label (str): label text for the input. Defaults to 'Buscar Tutor'.
    placeholder (str): placeholder text.
    search_url (str): endpoint for tutor search. Defaults to url_for('buscar_tutores').
    hidden_field_name (str): optional hidden input name to store selected tutor id.
    hidden_field_id (str): optional id for the hidden input. Defaults to `<id_prefix>-value` when hidden_field_name provided.
    hidden_field_value (str): optional preset value for hidden input.
    wrapper_class (str): additional classes for root container.
    input_class (str): additional classes for the visible input.
    help_text (str): optional helper text rendered below the field.
    min_chars (int): minimum characters required to trigger search. Defaults to 2.
    requires_selection (bool): when true, sets data attribute to require selection before submission.
    redirect_template (str): optional URL template with `{id}` placeholder used for redirection on selection.
    list_aria_label (str): accessible label for suggestion list.
#}
{% set base_id = id_prefix | default('tutor-search', true) %}
{% set input_id = base_id ~ '-input' %}
{% set list_id = base_id ~ '-listbox' %}
{% set status_id = base_id ~ '-status' %}
{% set root_class = 'tutor-search' %}
{% if wrapper_class is defined and wrapper_class %}
  {% set root_class = root_class ~ ' ' ~ wrapper_class %}
{% endif %}
{% if hidden_field_name is defined and hidden_field_name %}
  {% set hidden_id = hidden_field_id if hidden_field_id is defined else base_id ~ '-value' %}
{% endif %}
<div class="{{ root_class }}"
     data-module="tutor-search"
     data-search-url="{{ search_url | default(url_for('buscar_tutores')) }}"
     data-min-chars="{{ min_chars | default(2) }}"
     data-option-id-prefix="{{ list_id }}-option-"
     {% if hidden_field_name is defined and hidden_field_name %}data-hidden-input-id="{{ hidden_id }}"{% endif %}
     {% if redirect_template %}data-redirect-template="{{ redirect_template }}"{% endif %}
     {% if requires_selection %}data-requires-selection="true"{% endif %}>
  <label for="{{ input_id }}" class="form-label">{{ label | default('Buscar Tutor') }}</label>
  <div class="position-relative"
       data-tutor-search-combobox
       role="combobox"
       aria-haspopup="listbox"
       aria-owns="{{ list_id }}"
       aria-expanded="false"
       aria-busy="false">
    <input type="text"
           id="{{ input_id }}"
           class="form-control {{ input_class | default('') }}"
           placeholder="{{ placeholder | default('Digite nome, e-mail, CPF ou telefone') }}"
           aria-autocomplete="list"
           aria-controls="{{ list_id }}"
           aria-describedby="{{ status_id }}"
           autocomplete="off"
           data-tutor-search-input>
    {% if hidden_field_name is defined and hidden_field_name %}
    <input type="hidden"
           name="{{ hidden_field_name }}"
           id="{{ hidden_id }}"
           {% if hidden_field_value is defined %}value="{{ hidden_field_value }}"{% endif %}>
    {% endif %}
    <ul class="list-group position-absolute w-100 mt-1 d-none"
        id="{{ list_id }}"
        role="listbox"
        aria-label="{{ list_aria_label | default('SugestÃµes de tutores') }}"
        data-tutor-search-list
        style="z-index: 1000;"></ul>
  </div>
  {% if help_text %}
  <div class="form-text">{{ help_text }}</div>
  {% endif %}
  <div id="{{ status_id }}"
       class="visually-hidden"
       role="status"
       aria-live="polite"
       data-tutor-search-status></div>
</div>
