{% extends "layout.html" %}

{% block main %}
<style>
    .home-card {
        padding: var(--space-5);
        margin-top: var(--space-6);
        margin-bottom: var(--space-5);
        border-radius: 1rem;
    }

    .home-card--muted {
        background: #f8f9fa;
    }

    .home-card--white {
        background: #ffffff;
    }

    .home-cta-grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: var(--space-4);
        justify-items: center;
    }

    .home-cta {
        display: flex;
        flex-direction: column;
        gap: var(--space-3);
        align-items: center;
        text-align: center;
    }

    .accounting-actions {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(190px, 1fr));
        gap: var(--space-3);
        justify-items: center;
    }

    @media (min-width: 768px) and (max-width: 1199.98px) {
        .home-cta-grid,
        .accounting-actions {
            grid-template-columns: repeat(2, minmax(0, 1fr));
        }
    }

    @media (min-width: 1200px) {
        .home-cta-grid {
            grid-template-columns: repeat(4, minmax(0, 1fr));
        }
    }

    .accounting-card .accounting-btn {
        border-radius: 999px;
        color: #fff;
        border: none;
        padding: 0.75rem 1.75rem;
        min-width: 190px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 0.4rem;
        font-weight: 600;
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.08);
        transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .accounting-card .accounting-btn i {
        font-size: 1rem;
    }

    .accounting-card .accounting-btn:hover {
        transform: translateY(-1px);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.12);
        color: #fff;
    }
</style>
<div class="container text-center">

    {% if current_user.is_authenticated %}
        <!-- Ãrea pessoal -->
        <div class="card shadow-sm rounded-4 home-card home-card--muted">
            <h5 class="mb-4">Bem-vindo(a)! O que vocÃª deseja fazer hoje?</h5>

            <div class="home-cta-grid">
                <!-- Lottie: Add Animal -->
                <div class="home-cta">
                    <lottie-player src="https://assets5.lottiefiles.com/packages/lf20_ghs9bthn.json"
                                   background="transparent" speed="1" style="height: 100px;" loop autoplay></lottie-player>
                    <a href="{{ url_for('add_animal') }}" class="btn btn-outline-success rounded-pill shadow-sm px-4 py-2"
                       data-bs-toggle="tooltip" title="Cadastre um novo animal na plataforma.">
                        â• Cadastrar novo animal
                    </a>
                </div>

                <!-- Lottie: List Animals -->
                <div class="home-cta">
                    <lottie-player src="https://assets4.lottiefiles.com/packages/lf20_qp1q7mct.json"
                                   background="transparent" speed="1" style="height: 100px;" loop autoplay></lottie-player>
                    <a href="{{ url_for('list_animals') }}" class="btn btn-outline-primary rounded-pill shadow-sm px-4 py-2"
                       data-bs-toggle="tooltip" title="Veja todos os animais disponÃ­veis.">
                        ğŸ“‹ Ver todos os animais
                    </a>
                </div>

                <!-- Lottie: Health -->
                <div class="home-cta">
                    <lottie-player src="https://assets10.lottiefiles.com/packages/lf20_ksixj2kx.json"
                                   background="transparent" speed="1" style="height: 100px;" loop autoplay></lottie-player>
                    <a href="{{ url_for('plano_saude_overview') }}" class="btn btn-outline-info rounded-pill shadow-sm px-4 py-2"
                       data-bs-toggle="tooltip" title="ConheÃ§a nosso plano de saÃºde para pets.">
                        â¤ï¸ Plano de SaÃºde Pet
                    </a>
                </div>

                <!-- Lottie: Store -->
                <div class="home-cta">
                    <lottie-player src="https://assets10.lottiefiles.com/packages/lf20_sGqAqL.json"
                                   background="transparent" speed="1" style="height: 100px;" loop autoplay></lottie-player>
                    <a href="{{ url_for('loja') }}"
                       class="btn rounded-pill shadow-sm loja-pet-filled px-4 py-2"
                       data-bs-toggle="tooltip"
                       title="Acesse nossa loja para encontrar tudo que seu pet precisa.">
                        ğŸ›ï¸ Loja Pet
                    </a>
                </div>
            </div>
        </div>
    {% else %}
        <!-- Visitante nÃ£o autenticado -->
        <div class="card shadow-lg rounded-4 home-card home-card--white">
            <div class="text-center">
                <img src="{{ url_for('static', filename='logo_pet.png') }}"
                     alt="Logo PetOrlÃ¢ndia"
                     class="mb-4 logo-img mx-auto">
            </div>

            <p class="lead">
                PetOrlÃ¢ndia Ã© um espaÃ§o completo para quem ama e cuida dos animais. Aqui vocÃª pode adotar, doar, agendar atendimentos veterinÃ¡rios e encontrar tudo o que seu pet precisa â€” com carinho, responsabilidade e praticidade.
            </p>
            
            <div class="d-flex justify-content-center gap-3 mt-4">
                
                <a href="{{ url_for('register') }}" class="btn btn-outline-success rounded-pill px-4 py-2">ğŸ§‘ Criar Conta</a>
               
                <a href="{{ url_for('login_view') }}" class="btn btn-outline-primary rounded-pill px-4 py-2">ğŸ” Entrar</a>
            </div>
        </div>
    {% endif %}

    {% if current_user.is_authenticated and (current_user.worker == 'colaborador' or is_active_veterinarian) %}
    <!-- Ãrea profissional -->
        <div class="card shadow-lg rounded-4 home-card home-card--white">
            <h5 class="mb-4">Ãrea profissional</h5>
            <div class="d-flex flex-wrap justify-content-center gap-3">
                <a href="{{ url_for('novo_animal') }}" class="btn btn-outline-primary rounded-pill shadow-sm px-4 py-2"
                   data-bs-toggle="tooltip" title="Gerencie os animais vinculados a tutores.">
                    ğŸ¶ Animais
                </a>

                <a href="{{ url_for('tutores') }}" class="btn btn-outline-secondary rounded-pill shadow-sm px-4 py-2"
                   data-bs-toggle="tooltip" title="Veja os tutores cadastrados.">
                    ğŸ‘¥ Tutores
                </a>

                {% if current_user.worker == 'colaborador' or (is_active_veterinarian and current_user.veterinario) %}
                <a href="{{ url_for('appointments') }}"
                   class="btn btn-outline-warning rounded-pill shadow-sm px-4 py-2"
                   data-bs-toggle="tooltip" title="Administre sua agenda de atendimentos.">
                    ğŸ—“ï¸ Agenda
                </a>
                {% endif %}
            </div>
        </div>
    {% endif %}

    {% if current_user.is_authenticated %}
        {% set owned_clinics = current_user.clinicas or [] %}
        {% set has_admin_role = current_user.role in ['admin', 'master'] %}
        {% set admin_worker_roles = ['gestor', 'administrador', 'admin_clinica', 'master'] %}
        {% set has_admin_worker = current_user.worker in admin_worker_roles %}
        {% set owner_with_access = owned_clinics|length > 0 and can_access_accounting %}
        {% if has_admin_role or has_admin_worker or owner_with_access %}
        <div class="card shadow-lg rounded-4 home-card home-card--white accounting-card">
            <h5 class="mb-4 text-center">Contabilidade</h5>
            <div class="accounting-actions">
                <a href="/contabilidade/financeiro" class="btn accounting-btn" style="background-color: #4A90E2;">
                    <i class="fa-solid fa-chart-line"></i>
                    <span>Financeiro</span>
                </a>
                <a href="/contabilidade/pagamentos" class="btn accounting-btn" style="background-color: #6f42c1;">
                    <i class="fa-solid fa-briefcase"></i>
                    <span>Pagamentos / PJs</span>
                </a>
                <a href="/contabilidade/obrigacoes" class="btn accounting-btn" style="background-color: #f4b400; color: #4a3c00;">
                    <i class="fa-solid fa-file-invoice-dollar"></i>
                    <span>ObrigaÃ§Ãµes</span>
                </a>
            </div>
        </div>
        {% endif %}
    {% endif %}

    {% if current_user.is_authenticated and current_user.worker == 'delivery' %}
    <!-- Ãrea de Entregas -->
        <div class="card shadow-lg rounded-4 home-card home-card--white">
            <h5 class="mb-4">Ãrea de Entregas</h5>
            <div class="d-flex flex-wrap justify-content-center gap-3">
                <a href="{{ url_for('list_delivery_requests') }}" class="btn btn-outline-secondary rounded-pill shadow-sm px-4 py-2">
                    ğŸšš SolicitaÃ§Ãµes
                </a>
            </div>
        </div>
    {% endif %}
</div>
{% endblock %}
