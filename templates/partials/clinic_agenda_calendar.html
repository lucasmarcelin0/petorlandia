{% set calendar_dom_id = 'clinic-agenda-calendar-' ~ clinica.id %}
<div class="card shadow-sm">
  <div class="card-body">
    <div
      id="{{ calendar_dom_id }}"
      class="clinic-agenda-calendar"
      data-calendar-events='{{ appointments_events|tojson }}'
    ></div>
    <p class="small text-muted mt-3 mb-0">
      üí° Utilize as setas ou clique em um dia para explorar os compromissos desta cl√≠nica no modo calend√°rio.
    </p>
  </div>
</div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css">
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    var calendarEl = document.getElementById('{{ calendar_dom_id }}');
    if (!calendarEl) {
      return;
    }
    if (typeof FullCalendar === 'undefined') {
      console.warn('FullCalendar n√£o est√° dispon√≠vel para a agenda da cl√≠nica.');
      return;
    }
    var events = [];
    try {
      events = JSON.parse(calendarEl.dataset.calendarEvents || '[]');
    } catch (error) {
      console.warn('N√£o foi poss√≠vel carregar os eventos do calend√°rio da cl√≠nica.', error);
    }
    var calendar = new FullCalendar.Calendar(calendarEl, {
      initialView: 'dayGridMonth',
      height: 'auto',
      events: events,
      nowIndicator: true,
      navLinks: true,
      headerToolbar: {
        start: 'prev,next today',
        center: 'title',
        end: 'dayGridMonth,timeGridWeek,timeGridDay,listWeek'
      },
      buttonText: {
        today: 'Hoje',
        month: 'M√™s',
        week: 'Semana',
        day: 'Dia',
        list: 'Lista'
      }
    });
    calendar.render();
  });
</script>
