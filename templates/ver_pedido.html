{% extends "layout.html" %}
{% block main %}
<div class="container mt-4">
  <h2>Pedido #{{ pedido.id }}</h2>

  <p><strong>Data:</strong> {{ pedido.created_at|datetime_brazil }}</p>
  <p><strong>Total:</strong> R$ {{ "%.2f"|format(pedido.total_value()) }}</p>

  <h4 class="mt-4">Itens</h4>
  <ul class="list-unstyled">
    {% for item in pedido.items %}
      <li>• {{ item.item_name }} — {{ item.quantity }}× — R$ {{ "%.2f"|format(item.unit_price or item.product.price) }}</li>
    {% endfor %}
  </ul>

  <h4 class="mt-4">Pagamento</h4>
  {% if pedido.payment %}
      <p>Status: {{ pedido.payment.status.value }}</p>
      <p>ID da transação: {{ pedido.payment.transaction_id }}</p>
  {% else %}
      <p>Aguardando pagamento.</p>
  {% endif %}

  {% if pedido.delivery_requests|length %}
      <h4 class="mt-4">Entrega</h4>
      {% set dr = pedido.delivery_requests[0] %}
      <p>Status da entrega: {{ dr.status }}</p>
      {% if dr.worker %}<p>Entregador: {{ dr.worker.name }}</p>{% endif %}
  {% endif %}
</div>
{% endblock %}
